# ============================================
# Podman Quadlet é…ç½®æ–‡ä»¶
# ğŸ’¡ Fedora æ¨èçš„ systemd åŸç”Ÿå®¹å™¨ç®¡ç†æ–¹å¼
# ä½œè€…: CJX
# é¡¹ç›®: SMLYFM.github.io
#
# å®‰è£…æ­¥éª¤:
#   1. mkdir -p ~/.config/containers/systemd
#   2. cp smlyfm-blog.container ~/.config/containers/systemd/
#   3. systemctl --user daemon-reload
#   4. systemctl --user start smlyfm-blog
#   5. systemctl --user enable smlyfm-blog  # å¼€æœºè‡ªå¯
#
# æŸ¥çœ‹çŠ¶æ€:
#   systemctl --user status smlyfm-blog
#   podman logs smlyfm-blog
# ============================================

[Unit]
Description=SMLYFM Blog Container
After=local-fs.target

[Container]
# ğŸ’¡ é•œåƒé…ç½®
Image=localhost/smlyfm-blog:latest
ContainerName=smlyfm-blog

# ğŸ’¡ ç«¯å£æ˜ å°„
PublishPort=8080:80

# ğŸ’¡ èµ„æºé™åˆ¶ï¼ˆå¯é€‰ï¼‰
# Memory=512M
# CPUQuota=50%

# ğŸ’¡ æ—¥å¿—é…ç½®
LogDriver=journald

# ğŸ’¡ ç¯å¢ƒå˜é‡
Environment=TZ=Asia/Shanghai

# ğŸ’¡ å¥åº·æ£€æŸ¥
HealthCmd=wget --no-verbose --tries=1 --spider http://localhost/ || exit 1
HealthInterval=30s
HealthTimeout=3s
HealthRetries=3
HealthStartPeriod=10s

# ğŸ’¡ è‡ªåŠ¨æ›´æ–°ï¼ˆéœ€è¦ podman-auto-update.timerï¼‰
AutoUpdate=registry

# ğŸ’¡ å®‰å…¨é…ç½®
NoNewPrivileges=true
ReadOnly=true
# æŒ‚è½½ä¸´æ—¶ç›®å½•ç”¨äº nginx
Volume=/tmp

[Service]
Restart=always
TimeoutStartSec=60

[Install]
# ğŸ’¡ ç™»å½•åè‡ªåŠ¨å¯åŠ¨
WantedBy=default.target
